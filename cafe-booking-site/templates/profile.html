{% extends "base.html" %}

{% block content %}
<!-- В user-card добавить: -->
<div style="background: linear-gradient(90deg, #f1c40f, #e67e22); color: black; padding: 10px; border-radius: 8px; margin-bottom: 15px; font-weight: bold;">
    <i class="fas fa-crown"></i> {{ bonuses }} баллов
</div>

<div class="profile-dashboard">
    
    <!-- ЛЕВАЯ КОЛОНКА -->
    <aside class="profile-sidebar">
        <div class="user-card">
            <div class="user-avatar">
                {{ username[0] | upper }}
            </div>
            <h2 class="user-name">{{ username }}</h2>
            <p class="user-email">Участник Stoliki Club</p> <!-- Изменено -->
            
            <div class="user-stats">
                <div class="stat-item">
                    <h4>{{ bookings|length }}</h4>
                    <p>Брони</p>
                </div>
                <div class="stat-item">
                    <h4>0</h4>
                    <p>Пропуски</p>
                </div>
            </div>
            
            <a href="{{ url_for('booking') }}" class="btn btn-full" style="margin-top: 20px;">
                <i class="fas fa-plus"></i> Новая бронь
            </a>
            
            <a href="{{ url_for('logout') }}" class="btn-outline" style="display:block; margin-top: 10px; text-align:center; text-decoration:none;">
                Выйти
            </a>
        </div>
    </aside>

    <!-- ПРАВАЯ КОЛОНКА -->
    <div class="history-section">
        <h2>История визитов</h2> <!-- Изменено -->
        
        {% if bookings %}
            {% for booking in bookings %}
            <div class="ticket-card">
                <div class="ticket-left">
                    <span class="ticket-date-day">{{ booking.date.split('-')[2] }}</span>
                    <span class="ticket-date-month">
                        {% set month = booking.date.split('-')[1] %}
                        {% if month == '01' %}ЯНВ{% elif month == '02' %}ФЕВ{% elif month == '03' %}МАР{% elif month == '04' %}АПР{% elif month == '05' %}МАЙ{% elif month == '06' %}ИЮН{% elif month == '07' %}ИЮЛ{% elif month == '08' %}АВГ{% elif month == '09' %}СЕН{% elif month == '10' %}ОКТ{% elif month == '11' %}НОЯ{% else %}ДЕК{% endif %}
                    </span>
                </div>
                
                <div class="ticket-right">
                    <div class="ticket-info">
                        <h3>{{ booking.cafe_name }}</h3>
                        <p><i class="fas fa-chair"></i> Стол №{{ booking.table_number }} • {{ booking.seats }} персон</p>
                        <p style="margin-top: 5px; font-size: 0.8rem; opacity: 0.5;">ID: #{{ 1000 + loop.index }}</p>
                    </div>
                    
                    <div class="ticket-meta">
                        <span class="ticket-time">{{ booking.time }}</span>
                        <span class="ticket-status">Активно</span>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div style="text-align: center; padding: 50px; background: #1a1a1a; border-radius: 16px; border: 1px dashed #333;">
                <i class="fas fa-couch" style="font-size: 3rem; color: #333; margin-bottom: 20px;"></i>
                <p>Здесь пока пусто. Забронируйте свой первый столик!</p>
                <a href="{{ url_for('booking') }}" class="btn" style="margin-top: 10px;">Выбрать ресторан</a>
            </div>
        {% endif %}
    </div>

</div>
{% endblock %}
